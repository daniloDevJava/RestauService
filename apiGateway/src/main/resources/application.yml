spring:
  application:
    name: apiGateway

  cloud:
    gateway:
      discovery:
        locator:
          enabled: true # Activer la découverte des services via Eureka
      globalcors:
        corsConfigurations:
          '[/**]': # Appliquer les règles de CORS à toutes les routes
            allowedOrigins: 
              - "http://localhost:5005" # Origine du frontend
            allowedMethods:
              - GET
              - POST
              - PUT
              - DELETE
              - OPTIONS
            allowedHeaders:
              - "*"
            allowCredentials: true # Autoriser les cookies et les informations d'identité (ex : tokens)

  devtools:
    livereload:
      enabled: false # Désactiver le rechargement live pour améliorer les performances

  main:
    web-application-type: reactive # Mode web réactif pour Spring Cloud Gateway

server:
  port: 6005 # Port sur lequel l'API Gateway est accessible

logging:
  level:
    org.springframework.cloud.gateway: DEBUG # Activer les logs pour Gateway
    reactor.netty.http.client: DEBUG # Activer les logs pour le client HTTP (Netty)
    org.springframework.web: DEBUG

debug: true # Mode débogage activé

eureka:
  client:
    service-url:
      defaultZone: http://eureka:8761/eureka/
    register-with-eureka: true
    instance:
      prefer-ip-address: false

routes:
  - id: dao
    uri: lb://FOODGO-DAO
    predicates:
      - Path=/dao/**
    
  - id: user_account
    uri: lb://FOODGO-CONNEXIONETCOMPTES
    predicates:
      - Path=/user-management/**
    
  - id: location
    uri: lb://GEOLOCALISATION-SERVICE
    predicates:
      - Path=/geolocalisation/**
  
  - id: payment
    uri: lb://PAYMENT-SERVICE
    predicates:
      - Path=/payment/**
      
